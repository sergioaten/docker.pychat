name: Testing customaction

on:
  push:
    branches: ["test-customaction"]

jobs:
  test:
    # Add 'id-token' with the intended permissions for workload identity federations
    permissions:
      contents: "read"
      id-token: "write"

    runs-on: ubuntu-latest

    steps:
      - name: Checkout
        id: test1
        uses: actions/checkout@v2

      - name: test3
        id: test3
        run: |
          exit 1

      - name: test2
        id: test2
        run: |
          echo '${{ toJson(steps) }}'

      - name: test
        if: always()
        uses: sergioaten/msteams-notifications@main
        with:
          webhook: ${{ secrets.MSTEAMS_WEBHOOK_PYCHAT }}
          factsTitle: <h1><strong>App details</h1></strong>
          facts: |
            - Aplication name: pychat
            - Appliaction port: 5000
            - Application region: us-central1
          buttons: |
            - name: 'View commit'
              type: 'OpenUri'
              targets:
                - os: 'default'
                  uri: 'https://github.com/sergioaten/docker.pychat/commit/${{ github.sha }}'
            - name: 'Open App in browser'
              type: 'OpenUri'
              targets:
                - os: 'default'
                  uri: 'https://test.com'
